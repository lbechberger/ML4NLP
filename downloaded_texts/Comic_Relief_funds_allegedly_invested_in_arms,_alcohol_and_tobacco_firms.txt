Major British charity Comic Relief has invested money in arms, alcohol and tobacco firms, according to a BBC Panorama investigation to be broadcast this evening.

The probe discovered evidence of hundreds of thousands of pounds going towards shares in weapons firms like BAE Systems and alcohol company Diageo. It is also alleged to have pledged upwards of £3 million into tobacco firms.

Ethical fund manager Helen Wildsmith told Panorama: "If people who've been giving them money, after watching the television, next year think twice and don't give that money, because they're concerned about their investment policy, then that could be argued to be a breach of fiduciary duty. They're risking their reputation, and a charity's reputation is very precious."

Comic Relief was founded in 1985, and since then has taken in nearly £1 billion in donations. It funds charitable organisations in the United Kingdom as well as overseas. It uses a range of managed funds, which invests the money in the charity's name - including on the stock market - in order to maximise return.

A spokesperson for the charity told the British newspaper The Daily Telegraph: "We put the money into large managed funds, as many other leading charities and pension funds do. On balance, we believe this is the approach that will deliver the greatest benefits to the most vulnerable people."

The controversial investments were made between 2007 and 2009, Panorama explains. Peter Bennett-Jones, former chair of the company, defended the investments in a post on The Guardians website.

He said: "The Charity Commission guidance is quite clear that trustees must invest for the best possible financial return, while taking a level of risk appropriate for money in their care. They should only adopt an ethical investment approach with specific justification and not on the grounds of individual moral views. This sounds counterintuitive, but it is the law."